{
  "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
  "handler": "Microsoft.Azure.CreateUIDef",
  "version": "0.1.2-preview",
  "parameters": {
    "basics": [
      {

        "name": "applicationConfiguration",
        "type": "Microsoft.Common.Section",
        "label": "Application Configuration",
        "elements": [
          {
            "name": "applicationName",
            "type": "Microsoft.Common.TextBox",
            "label": "Application Name",
            "toolTip": "The name of your Application.",
            "defaultValue": "ptm-app01",
            "constraints": {
              "required": true,
              "regex": "^[a-z0-9-]{4,12}$",
              "validationMessage": "The Application Name must be between 4 and 12 characters long and contain letters, numbers and lowercase only."
            }
          }
        ]
      }
    ],
    "steps": [
      {
        "name": "databaseConfig",
        "label": "Database Configuration",
        "elements": [
          {
            "name": "databaseCredential",
            "type": "Microsoft.Common.Section",
            "label": "Database Credential",
            "elements": [
              {
                "name": "sqlLogin",
                "type": "Microsoft.Compute.UserNameTextBox",
                "label": "Username",
                "defaultValue": "",
                "toolTip": "input your username",
                "constraints": {
                  "required": true,
                  "regex": "^[a-z0-9]{1,30}$",
                  "validationMessage": "Only alphanumeric characters are allowed, lowercase and the value must be 1-30 characters long."
                },
                "osPlatform": "Windows",
                "visible": true
              },
              {
                "name": "sqlPassword",
                "type": "Microsoft.Compute.CredentialsCombo",
                "label": {
                  "password": "Password",
                  "confirmPassword": "Confirm password"
                },
                "toolTip": {
                  "password": ""
                },
                "constraints": {
                  "required": true,
                  "customPasswordRegex": "^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z])[\\w~@#$%^&*+=|{}:;!.?\\()\\[\\]-]{8,}$",
                  "customValidationMessage": "The password must contain at least 8 characters, with at least 1 uppercase, 1 lowercase and 1 number."
                },
                "options": {
                  "hideConfirmation": false
                },
                "osPlatform": "Windows",
                "visible": true
              }
            ]
          }
        ]
      },
      {
        "name": "tags",
        "label": "Tags",
        "elements": [
          {
            "name": "applicationTag",
            "type": "Microsoft.Common.TextBox",
            "label": "Application Tag",
            "defaultValue": "BIA 01",
            "toolTip": "",
            "constraints": {
              "required": false,
              "regex": "",
              "validationMessage": ""
            },
            "visible": true
          },
          {
                "name": "biaLevel",
                "type": "Microsoft.Common.DropDown",
                "label": "BIA Level",
                "placeholder": "",
                "defaultValue": "1",
                "toolTip": "",
                "constraints": {
                    "allowedValues": [
                        {
                            "label": "1",
                            "value": "1"
                        },
                        {
                            "label": "2",
                            "value": "2"
                        },
                        {
                            "label": "3",
                            "value": "3"
                        }
                    ],
                    "required": true
                },
                "visible": true
            },
          {
            "name": "departement",
            "type": "Microsoft.Common.TextBox",
            "label": "Departement",
            "defaultValue": "Business",
            "toolTip": "",
            "constraints": {
              "required": false,
              "regex": "",
              "validationMessage": ""
            },
            "visible": true
          }
        ]
      }
    ],
    "outputs": {

      "location": "[location()]",
      "applicationName": "[basics('applicationConfiguration').applicationName]",

      "username": "[steps('databaseConfig').databaseCredential.sqlLogin]",
      "password": "[steps('databaseConfig').databaseCredential.sqlPassword]",

      "applicationTag": "[steps('tags').applicationTag]",
      "biaLevel": "[steps('tags').biaLevel]",
      "departement": "[steps('tags').departement]"
    }
  }
}